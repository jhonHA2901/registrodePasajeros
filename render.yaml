services:
  # 1. Base de datos PostgreSQL
  # Esta definición asume que ya tienes una base de datos llamada 'registrop1-db' en Render.
  # Si tiene otro nombre, por favor ajústalo aquí y en las referencias de abajo.
  - type: psql
    name: registrop1-db
    plan: free

  # 2. Backend - Servicio Web para la API (Node.js)
  - type: web
    name: registrop1-backend
    env: node
    region: ohio
    plan: free
    # Apuntamos el directorio raíz a la carpeta del backend
    rootDir: backend 
    buildCommand: "npm install"
    startCommand: "node server.js"
    envVars:
      - key: DATABASE_URL # Usamos la URL de conexión completa, es más robusto
        fromDatabase:
          name: registrop1-db
          property: connectionString
      - key: NODE_ENV
        value: production

  # 3. Frontend - Sitio Estático (HTML, CSS, JS)
  - type: static
    name: registrop1-frontend
    region: ohio
    plan: free
    # Apuntamos el directorio raíz a la carpeta del frontend
    rootDir: frontend 
    routes:
      # Para aplicaciones de una sola página (SPA), reescribimos todo a index.html
      - type: rewrite
        source: /*
        destination: /index.html
